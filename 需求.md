    关于进一步完善统一人证核验能力的需求

# 【需求背景】
在电信运营商销售中，个人客户办理业务迷，如办理手机卡等。
目前个人客户身份证件核验未形成中台能力，在日常生产过程中存在如下痛点：
1.每次新增证件类型，都需要逐个系统逐个界面增加，开发周期长，效率低，且容易遗漏，难以满足上级管理单位的要求；
2.部分证件开放范围有限，如临时身份证等仅能开放给部分营业厅，一旦开放范围变化，需要进行代码级改造，无法灵活进行调整。
为了解决上述痛点，实现个人客户证件的快速灵活部署，特申请建设统一证件能力。1月10日市场部已组织信息部相关人员围绕需求进行了讨论，拟定初步需求如下：
# 【需求内容】
一、增加证件类型配置界面，配置字段包括证件类型、证件号码、中文姓名、英文姓名、证件地址、生日、性别、证件有效期等字段，每个字段可配置必填或选填。 
二、增加证件应用范围配置界面
1.支持按办理通路（如云厅、网格通、便利店等，不含全网渠道，如京东OAO）、渠道小类、地市、区县、机构配置可使用的证件类型。配置项有冲突时以最末级配置为主。
2.配置界面可支持单个及批量导入配置，规则支持增、删、改、查询。
     三、省内所有系统同一业务的证件校验规则统一。

# 【证件验证规则表】
证件类型	证件类型	采集方式	填写字段	校验规则	照片
身份证	1	机读	姓名、证件号码、出生日期、民族、期限起始、签发机关、性别、期限终止、地址	见文件	1张人像照
武装警察身份证	14	机读	同上		1张人像照
军人身份证	24	机读	同上		1张人像照
外国人永久居留身份证	15	机读	（特殊）姓名、证件号码、出生日期、民族、期限起始、签发机关、性别、期限终止、地址、中文姓名、国籍		1张人像照
港澳台居民居住证	16	机读	（特殊）姓名、证件号码、出生日期、民族、期限起始、签发机关、性别、期限终止、地址、通行证号、签证次数		1张人像照
军官证	11	自定义	姓名、证件号码、出生日期、民族、期限起始、签发机关、性别、期限终止、地址		1张人像照、证件正面、证件反面
护照	3	自定义	同上		1张人像照、证件正面、证件反面
士兵证	2	自定义	同上		1张人像照、证件正面、证件反面
人民警察证	12	自定义	同上		1张人像照、证件正面、证件反面
台湾居民来往大陆通行证	13	自定义	同上		1张人像照、证件正面、证件反面、需要人证比对
港澳居民来往内地通行证	33	自定义	同上		1张人像照、证件正面、证件反面、需要人证比对
华侨护照	43	自定义	同上		1张人像照、证件正面、证件反面、需要人证比对
户口簿	22	自定义	同上		1张人像照、证件正面、证件反面、需要人证比对
临时居民身份证	23	自定义	同上		1张人像照、证件正面、证件反面、需要人证比对
港澳居民来往内地通行证(非中国籍)	20	自定义	姓名、证件号码、出生日期、民族、期限起始、签发机关、性别、期限终止、地址、通行证号		
# 旧版本硬编码实现的校验规则示例
``` js
/* 校验使用方式
	返回值 null:成功  具体错误信息:失败
	jsValidator.valid("require","msisdn",true);  js\customfunc\IBOPUtils.js
	返回值 同上
	$.validation.getRule("require").check(null,$('#msisdn').val())  js\jquery-validator-plugin.js
	返回值 true:成功  false:失败    ----和上面两个相反
	$('#msisdn').validate() js\jquery-validator-plugin.js
*/

//校验框架自定义扩展
$.validation.addRule("IBOPDEMO",{//ruleName为规则名称，即validation的规则定义
    check: function(value) {//规则校验接口，业务系统的规则校验就在这个接口里体现了
        if(value != "test") { //value即表单元素的当前值
            return "错误提示";
        }
        return null;
    }
});

/*
 * 是否手机号码判断
 * @__value 手机号码 不可空
 * @__is_yd boolean 可空
 */
$.validation.addRule("isMobile",{
    check: function(label,mobileNo,param) {
		if(mobileNo=="") return null;
		if(!param) param={};
		var errmsg=null;
		var reg = /^\d*$/;
		if(reg.test(mobileNo)){
		}else{
			errmsg="手机号码必须为数字,请重新输入";
		}
		if(errmsg && param.errMsg) errmsg=param.errMsg;
		//if(label && errmsg) errmsg=label+" 为"+errmsg;
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
		/*var reg1x = /(^1[3,4,5,7,8][0-9]{9}$)/;
		var reg2x = /(^1064[7,8][0-9]{8}$)/;
		var reg13x_yd = /(^134[0-8]{1}[0-9]{7}$)|(^13[5-9]{1}[0-9]{8}$)/;	
		var reg13x_lt = /(^13[0-2]{1}[0-9]{7}$)|(^13[5-9]{1}[0-9]{8}$)/;	
		var reg13x_dx = /(^1349[0-9]{7}$)|(^133[0-9]{8}$)/;	
		
		var reg14x_yd = /(^14[7,8][0-9]{8}$)/;
		
		var reg15x_yd = /(^15[0,1,2,7,8,9][0-9]{8}$)/;
		var reg15x_lt = /(^15[5,6][0-9]{8}$)/;
		var reg15x_dx = /(^153[0-9]{8}$)/;
		
		var reg162x_dx = /(^162[0-9]{8}$)/;
	    var reg165x_yd = /(^165[0-9]{8}$)/;
		var reg166x_lt = /(^166[0-9]{8}$)/;
		var reg167x_lt = /(^167[0-9]{8}$)/;
		
		var reg18x_yd = /(^18[2,3,4,7,8][0-9]{8}$)/;	
		var reg18x_lt = /(^18[5,6][0-9]{8}$)/;	
		var reg18x_dx = /(^18[0,1,9][0-9]{8}$)/;	
		
		var reg178x_yd = /(^178[0-9]{8}$)/;
		var reg172x_yd = /(^172[0-9]{8}$)/;
		var reg173x_dx = /(^173[0-9]{8}$)/;
		var reg174x_dx = /(^174[0-9]{8}$)/;
		
		var reg198x_yd = /(^198[0-9]{8}$)/;
		var reg191x_dx = /(^191[0-9]{8}$)/;
		var reg199x_dx = /(^199[0-9]{8}$)/;
		
		if(param.is_yd){
			if(reg13x_yd.test(mobileNo)||reg14x_yd.test(mobileNo)||reg15x_yd.test(mobileNo)
				||reg18x_yd.test(mobileNo)||reg2x.test(mobileNo)||reg178x_yd.test(mobileNo)
				||reg172x_yd.test(mobileNo)||reg198x_yd.test(mobileNo)){
			    
			}else {
				errmsg = "移动手机号码必须为13[5-9],134[0-8],14[7,8],15[0-2,7-9],18[2,3,4,7,8],178,172,198开头的11位数字或10648开头的13位号码,请重新输入";
			}
		}else{
			if(reg1x.test(mobileNo)||reg2x.test(mobileNo)||reg13x_yd.test(mobileNo)||reg13x_lt.test(mobileNo)||reg13x_dx.test(mobileNo)
				||reg14x_yd.test(mobileNo)||reg15x_yd.test(mobileNo)||reg15x_lt.test(mobileNo)||reg15x_dx.test(mobileNo)
				||reg162x_dx.test(mobileNo)||reg165x_yd.test(mobileNo)||reg166x_lt.test(mobileNo)||reg167x_lt.test(mobileNo)
				||reg178x_yd.test(mobileNo)||reg172x_yd.test(mobileNo)||reg174x_dx.test(mobileNo)||reg173x_dx.test(mobileNo)
				||reg18x_yd.test(mobileNo)||reg18x_lt.test(mobileNo)||reg18x_dx.test(mobileNo)
				||reg198x_yd.test(mobileNo)||reg191x_dx.test(mobileNo)||reg199x_dx.test(mobileNo)){
			    
			}else {
				errmsg="手机号码必须为13,14,15,17,18,162,165,166,167,191,198,199开头的11位数字或10648开头的13位号码,请重新输入";
			}
		}*/
		
    }
});

/*
 * 是否手机号码判断
 * 手机号码 不可空
 * 手机号码必须为13,14,15,17,18,162,165,166,167,191,198,199开头的11位数字或10648开头的13位号码
 */
$.validation.addRule("isMobileOld",{
    check: function(label,mobileNo,param) {
		if(mobileNo=="") return null;
		if(!param) param={};
		var reg1x = /(^1[3,4,5,7,8][0-9]{9}$)/;
		var reg2x = /(^1064[7,8][0-9]{8}$)/;
		var reg13x_yd = /(^134[0-8]{1}[0-9]{7}$)|(^13[5-9]{1}[0-9]{8}$)/;	
		var reg13x_lt = /(^13[0-2]{1}[0-9]{7}$)|(^13[5-9]{1}[0-9]{8}$)/;	
		var reg13x_dx = /(^1349[0-9]{7}$)|(^133[0-9]{8}$)/;	
		
		var reg14x_yd = /(^14[7,8][0-9]{8}$)/;
		
		var reg15x_yd = /(^15[0,1,2,7,8,9][0-9]{8}$)/;
		var reg15x_lt = /(^15[5,6][0-9]{8}$)/;
		var reg15x_dx = /(^153[0-9]{8}$)/;
		
		var reg162x_dx = /(^162[0-9]{8}$)/;
	    var reg165x_yd = /(^165[0-9]{8}$)/;
		var reg166x_lt = /(^166[0-9]{8}$)/;
		var reg167x_lt = /(^167[0-9]{8}$)/;
		
		var reg18x_yd = /(^18[2,3,4,7,8][0-9]{8}$)/;	
		var reg18x_lt = /(^18[5,6][0-9]{8}$)/;	
		var reg18x_dx = /(^18[0,1,9][0-9]{8}$)/;	
		
		var reg178x_yd = /(^178[0-9]{8}$)/;
		var reg172x_yd = /(^172[0-9]{8}$)/;
		var reg174x_dx = /(^174[0-9]{8}$)/;
		
		var reg198x_yd = /(^198[0-9]{8}$)/;
		var reg191x_dx = /(^191[0-9]{8}$)/;
		var reg199x_dx = /(^199[0-9]{8}$)/;
		
		var errmsg=null;
		if(param.is_yd){
			if(reg13x_yd.test(mobileNo)||reg14x_yd.test(mobileNo)||reg15x_yd.test(mobileNo)
				||reg18x_yd.test(mobileNo)||reg2x.test(mobileNo)||reg178x_yd.test(mobileNo)
				||reg172x_yd.test(mobileNo)||reg198x_yd.test(mobileNo)){
			    
			}else {
				errmsg = "移动手机号码必须为13[5-9],134[0-8],14[7,8],15[0-2,7-9],18[2,3,4,7,8],178,172,198开头的11位数字或10648开头的13位号码,请重新输入";
			}
		}else{
			if(reg1x.test(mobileNo)||reg2x.test(mobileNo)||reg13x_yd.test(mobileNo)||reg13x_lt.test(mobileNo)||reg13x_dx.test(mobileNo)
				||reg14x_yd.test(mobileNo)||reg15x_yd.test(mobileNo)||reg15x_lt.test(mobileNo)||reg15x_dx.test(mobileNo)
				||reg162x_dx.test(mobileNo)||reg165x_yd.test(mobileNo)||reg166x_lt.test(mobileNo)||reg167x_lt.test(mobileNo)
				||reg178x_yd.test(mobileNo)||reg172x_yd.test(mobileNo)||reg174x_dx.test(mobileNo)
				||reg18x_yd.test(mobileNo)||reg18x_lt.test(mobileNo)||reg18x_dx.test(mobileNo)
				||reg198x_yd.test(mobileNo)||reg191x_dx.test(mobileNo)||reg199x_dx.test(mobileNo)){
			    
			}else {
				errmsg="手机号码必须为13,14,15,17,18,162,165,166,167,191,198,199开头的11位数字或10648开头的13位号码,请重新输入";
			}
		}
		if(errmsg && param.errMsg) errmsg=param.errMsg;
		if(label && errmsg) errmsg=label+" 为"+errmsg;
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});

/**isIMSPhoneOrMobileNo
 *验证是否是电话号码,可以是手机号码,也可以是IMS固话号码
 *　(1)IMS固话号码为10位
 *　(2)移动电话号码为11位
 */
$.validation.addRule("isIMSPhoneOrMobileNo",{
    check: function(label,phoneNo,param) {
		if(phoneNo=="") return null;
		if(!param) param={};
		var errmsg=null;
		var reg =/(^59[0-9]{8,9}$)/;
		
		if(reg.test(phoneNo)|| !$.validation.getRule("isMobile").check(label,phoneNo)){return null;}
		else{
			errmsg = "无效的手机号码或IMS固话号码,请重新输入.";
	    };
		
		if(label && errmsg) errmsg=label+" 为"+errmsg;
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});



/**isIDCardNo
 *验证身份证,无效身份证
 */
$.validation.addRule("isIDCardNo",{
    check: function(tips,idcard,param) {
		if(!param) param={};
		var errmsg=null;
		var icType=$(param.ic_type_id).val();
		var gatMsg = "无效身份证格式:身份证地区非法，请重新输入";
		if(icType && icType != "16" && (idcard.substring(0,2) == "81" || idcard.substring(0,2) == "82" || idcard.substring(0,2) == "83")) gatMsg = "证件类型错误，请重新选择证件类型";
		var Errors = new Array(
			"无效身份证格式:身份证号码位数不对,请重新输入",
			"无效身份证格式:身份证号码出生日期超出范围或含有非法字符，请重新输入",
			"无效身份证格式:身份证真实性校验不通过！请确认输入号码无误，或确认身份证真伪",
			gatMsg,
			"请输入证件号码",
			"请输入正确的身份证号码!"
		);
		if(tips!=null && tips!="undefined" && tips!=""){
			Errors[0]=tips+"身份证号码位数不对,请重新输入";
			Errors[1]=tips+"身份证号码出生日期超出范围或含有非法字符，请重新输入";
			Errors[2]=tips+"身份证真实性校验不通过！请确认输入号码无误，或确认身份证真伪";
			Errors[3]=tips+gatMsg;
			Errors[4]="请输入"+tips;
			Errors[5]=tips+"为无效的身份证号码，请重新输入!";
		}
		var area = {11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",
					23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",
					41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",
					52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",
					71:"台湾",91:"国外"
				}
		if(icType == "16") area = {81:"香港",82:"澳门",83:"台湾"};
		var Y,JYM;
		var S,M;
		var idcard_array = new Array();
		if(idcard == ""){//判断是否输入号码
			return null;
		}else if(icType == "15"){
			ereg=/^[a-zA-Z]{3}\d{12}$/;//外国人居留许可证var RegEx = /^[a-zA-Z]{3}\d{12}$/;//外国人居留许可证
			if(ereg.test(idcard)){}
			else {
				errmsg=Errors[5];
			}
		}else{
			idcard_array = idcard.split("");
			//地区检验
			if(area[parseInt(idcard.substr(0,2))]==null){
				errmsg=Errors[3];
			}else{
				//身份号码位数及格式检验
				switch(idcard.length){
				case 15:
						if ( (parseInt(idcard.substr(6,2))+1900) % 4 == 0 || ((parseInt(idcard.substr(6,2))+1900) % 100 == 0 && (parseInt(idcard.substr(6,2))+1900) % 4 == 0 )){
						ereg=/^[1-9][0-9]{5}[1-9][0-9]((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}$/;//测试出生日期的合法性
						} else {
						ereg=/^[1-9][0-9]{5}[1-9][0-9]((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}$/;//测试出生日期的合法性
						}
						if(ereg.test(idcard)){}
						else {
							errmsg=Errors[1];
						}
						break;
				case 18:
						//18位身份号码检测
						//出生日期的合法性检查
						//闰年月日:((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))
						//平年月日:((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))
						var idcardDate = idcard.substr(6,8)+"000000";
						var nowDate = IBOP.util.Time.getToday();
						//日期在1910/01/01到当前日期
						if(IBOP.util.Time.DateDiff(idcardDate,"19100101000000","day")<0 || IBOP.util.Time.DateDiff(idcardDate,nowDate,"day")>0){
							errmsg=Errors[2];
							break;
						}
						if ( parseInt(idcard.substr(6,4)) % 4 == 0 || (parseInt(idcard.substr(6,4)) % 100 == 0 && parseInt(idcard.substr(6,4))%4 == 0 )){
							ereg=/^[1-9][0-9]{5}(19|2[0-9])[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}[0-9Xx]$/;//闰年出生日期的合法性正则表达式
						} else {
							ereg=/^[1-9][0-9]{5}(19|2[0-9])[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}[0-9Xx]$/;//平年出生日期的合法性正则表达式
						}
						if(ereg.test(idcard)){//测试出生日期的合法性
							//计算校验位
							S = (parseInt(idcard_array[0]) + parseInt(idcard_array[10])) * 7
							+ (parseInt(idcard_array[1]) + parseInt(idcard_array[11])) * 9
							+ (parseInt(idcard_array[2]) + parseInt(idcard_array[12])) * 10
							+ (parseInt(idcard_array[3]) + parseInt(idcard_array[13])) * 5
							+ (parseInt(idcard_array[4]) + parseInt(idcard_array[14])) * 8
							+ (parseInt(idcard_array[5]) + parseInt(idcard_array[15])) * 4
							+ (parseInt(idcard_array[6]) + parseInt(idcard_array[16])) * 2
							+ parseInt(idcard_array[7]) * 1
							+ parseInt(idcard_array[8]) * 6
							+ parseInt(idcard_array[9]) * 3 ;
							Y = S % 11;
							M = "F";
							JYM = "10X98765432";
							JYM2 = "10x98765432";
							M = JYM.substr(Y,1);//判断校验位当前只接受是字母X或x.
							M2 = JYM2.substr(Y,1);//x
							if(M == idcard_array[17] || M2 == idcard_array[17]){
							
							}else {
								errmsg=Errors[2];
							}
						}
						else  {
							errmsg=Errors[1];
						}
						break;
				default:
						errmsg=Errors[0];
						break;
				}
			}
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});


/**isHKIDCardNo
 *验证香港身份证
 */
$.validation.addRule("isHKIDCardNo",{
    check: function(tips,idcard,param) {
		if(!param) param={};
		var errmsg=null;
		var Errors = new Array(
			"无效身份证格式:身份证号码位数不对,请重新输入",
			"无效身份证格式:身份证号码是非数字或含有非法字符，请重新输入",
			"无效身份证格式:身份证格式不对！请确认输入格式无误，请重新输入",
			"请输入证件号码"
		);
		if(tips!=null && tips!="undefined" && tips!=""){
			Errors[0]=tips+"身份证号码位数不对,请重新输入";
			Errors[1]=tips+"身份证号码是非数字或含有非法字符，请重新输入";
			Errors[2]=tips+"身份证真实性校验不通过！请确认输入号码无误，或确认身份证真伪";
			Errors[3]="请输入"+tips;
		}
		if(idcard == ""){//判断是否输入号码
			errmsg=Errors[3];
		}else if(idcard.length != '10' && idcard.length != '11'){//校验位数
			errmsg=Errors[0];
		}else{
			var rowPattern = /^[a-zA-Z]?[a-zA-Z]{1}\d{6}[(][a-z0-9A-Z]{1}[)]$/;
			if(rowPattern.test(idcard)){
				
			}else{
				errmsg=Errors[1];
			}
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});
 
/**isMacauIDCardNo
 *验证澳门身份证
 */
$.validation.addRule("isMacauIDCardNo",{
    check: function(tips,idcard,param) {
		if(!param) param={};
		var errmsg=null;
		var Errors = new Array(
			"无效身份证格式:身份证号码位数不对,请重新输入",
			"无效身份证格式:身份证号码是非数字或含有非法字符，请重新输入",
			"无效身份证格式:身份证格式不对！请确认输入格式无误，请重新输入",
			"请输入证件号码"
		);
		if(tips!=null && tips!="undefined" && tips!=""){
			Errors[0]=tips+"身份证号码位数不对,请重新输入";
			Errors[1]=tips+"身份证号码是非数字或含有非法字符，请重新输入";
			Errors[2]=tips+"身份证真实性校验不通过！请确认输入号码无误，或确认身份证真伪";
			Errors[3]="请输入"+tips;
		}
		if(idcard == ""){//判断是否输入号码
			errmsg=Errors[3];
		}else if(idcard.length != '10'){//校验位数
			errmsg=Errors[0];
		}else{
			var rowPattern = /^\d{1}[\/]\d{6}[\/]\d{1}$/; //旧式的澳门身份证格式
			var rowPattern2 = /^\d{7}[(]\d{1}[)]$/; //新式的澳门身份证格式
			if(rowPattern.test(idcard) || rowPattern2.test(idcard)){
				
			}else{
				errmsg=Errors[1];		
			}
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});

/**isHKMacauPassNo
 *验证港澳居民来往内地通行证
 */
$.validation.addRule("isHKMacauPassNo",{
    check: function(tips,idcard,param) {
		if(!param) param={};
		var errmsg=null;
		var msgs = "无效港澳居民来往内地通行证,请重新输入";
		if(tips != null){msgs = tips + "为无效港澳居民来往内地通行证,请重新输入."}
		if(idcard == ""){//判断是否输入号码
			errmsg=msgs;
		}else if(idcard.length != '9'){//校验位数
			errmsg=msgs;
		}else{
			var rowPattern = /^(H|M)[0-9]{0,8}$/;
            if(rowPattern.test(idcard)){
				
			}else{
				errmsg=msgs;
			}
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});

/**isTaiWanPassNo
 *验证台湾居民来往大陆通行证
 */
$.validation.addRule("isTaiWanPassNo",{
    check: function(tips,idcard,param) {
		if(!param) param={};
		var errmsg=null;
		var msgs = "无效台湾居民来往大陆通行证,请重新输入";
		if(tips != null){msgs = tips + "为无效台湾居民来往大陆通行证,请重新输入."}
		
		if(idcard == ""){//判断是否输入号码
			errmsg=msgs;
		}else{
            var rowPattern1 = /^[0-9]{8}$/;
            //var rowPattern2 = /^[0-9]{10}[A-Za-z0-9]$/;
            //var rowPattern3 = /^[0-9]{10}[(][A-Za-z0-9][)]$/;
            //var rowPattern4=  /^[0-9]{7}$/;
            //var rowPattern5=  /^(TW|LXZH)[A-Z0-9()（）]+$/;
            //if(rowPattern1.test(idcard) || rowPattern2.test(idcard) || rowPattern3.test(idcard)  || rowPattern4.test(idcard) || rowPattern5.test(idcard)){
            if(rowPattern1.test(idcard)){

            }else{
                errmsg=msgs;
            }
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});

/**checkIcNoByIcType
 *根据证件类型验证证件号码（证件类型定义见数据字典1101 4：）,返回具体错误信息为失败 成功返回null
 */ 
$.validation.addRule("checkIcNoByIcType",{
    check: function(label,idcard,param) {
		if(!param) param={};
		if(idcard=="") return null;
		if(typeof param == "string") param={ic_type_id:param};  //关联的证件类型
		var icType=$(param.ic_type_id).val();
		if(icType==""){
			return "校验规则checkIcNoByIcType 无法获取证件类型";
		}
		var errmsg=null;
		//if(reg.test(phoneNo)|| !$.validation.getRule("isMobile").check(label,phoneNo)){return null;}
		switch(parseInt(icType)) {
		case 1:	//身份证
		case 14:
		case 15:
		case 16:
		case 24:
			errmsg=$.validation.getRule("isIDCardNo").check(label,idcard,param);
			break;
		case 2:	//军官证
		case 3:	//护照
		//case 10:	//代办证件
		case 11:	//士兵证
		case 12:	//人民警察证
		case 43: //护照
			if(idcard.length<6){
				errmsg="为无效的证件号码，请重新输入";
				if(label) errmgs=label+errmsg;
			}
			break;
		case 13:	//台湾居民来往大陆通行证
			errmsg=$.validation.getRule("isTaiWanPassNo").check(label,idcard,param);
			break;
		case 22:	//户口簿
		case 23:	//临时身份证
			errmsg=$.validation.getRule("isIDCardNo").check(label,idcard,param);
			break;
		case 31:	//香港身份证
			errmsg=$.validation.getRule("isHKIDCardNo").check(label,idcard,param);
			break;
		case 32:	//澳门身份证
			errmsg=$.validation.getRule("isMacauIDCardNo").check(label,idcard,param);
			break;
		case 33:	//港澳居民来往内地通行证	
			errmsg=$.validation.getRule("isHKMacauPassNo").check(label,idcard,param);
			break;	
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;		
    }
});


/**checkUnitIcNoByIcType
 *根据证件类型验证单位证件号码（证件类型定义见数据字典1101 61）,返回具体错误信息为失败 成功返回null
 */ 
$.validation.addRule("checkUnitIcNoByIcType",{
    check: function(label,icNO,param) {
		if(!param) param={};
		if(icNO=="") return null;
		if(typeof param == "string") param={ic_type_id:param};  //关联的证件类型
		var icType=$(param.ic_type_id).val();
		var errmsg=null;
		//长度需10位，规则为“XXXXXXXX-X”，倒数第2位是“-”，前八位是数字(或大写拉丁字母)本体代码，最后一位是数字(或大写拉丁字母)校验码。 或者9位数字,或者18位数字或大写英文
		var exp1 = /^[0-9A-Z]{8}-[0-9A-Z]{1}$|^[0-9]{9}$|^[0-9A-Z]{18}$/g; 
		//var exp2 = /^\d{15}$/g; //长度需15位，且均为数字
		var exp2= /^[a-zA-Z0-9]{15}$|^[A-Z0-9]{18}$|^[A-Z0-9]{17}[*]{1}$/g; //长度需15或者18位，可以为数字或字母
		var exp3 = /^\d{12}$|^\d{18}|$/g; //号码长度需12位或18位，且均为数字
		var incldeNumAmount = $CommonUtil.getIncludeCharAmount(icNO, "Number");
		var msgs  = "无效的证件号码，请重新输入";
		switch(parseInt(icType)) {
			case 51:	//组织机构代码证
				if(!exp1.test(icNO)){
					errmsg="组织机构代码证号码长度需10位，规则为“XXXXXXXX-X”，请重新输入";			
				}
				break;	
			case 52:	//营业执照
				if(!exp2.test(icNO)){
					errmsg="组织机构代码证号码长度需15位，可以为数字或字母，请重新输入";		
				}
				break;	
			case 53:	//事业单位法人证书
				/*if(!exp3.test(icNO)){
					this.showError(msgs,fieldID);
					return false;			
				}*/
				if(icNO.length>30){
					errmsg=msgs;	
				}
				if(icNO==""){
					errmsg=msgs;	
				}
				break;
			case 54:	//社会团体法人登记证书
				/* 62385-调整单位客户证件号码判断条件的需求 修改内容：“对于社会团体法人登记证书，需填写证书上的编号，暂不校验证件号码”
				if(incldeNumAmount<4){
					this.showError(msgs,fieldID);
					return false;			
				}
				break;
				*/
				if(icNO==""){
					errmsg=msgs;		
				}
				break;
			case 55:    
				if(icNO==""){
					errmsg=msgs;	
				}
				break;	//介绍信
			case 56:	//身份证
				errmsg=$.validation.getRule("isIDCardNo").check(label,icNO,param);
				break;
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;		
    }
});



/**checkCustNameByIcType
 *根据证件类型验证客户姓名（证件类型定义见数据字典1101 4：）
 */
$.validation.addRule("checkCustNameByIcType",{
    check: function(tips,nameString,param) {
		if(!param) param={};
		if(nameString=="") return null;
		var errmsg=null;
		var icType="";
		if(param.ic_type_id){
			icType=$(param.ic_type_id).val();
		}
		if(icType==""){
			//showMsg("验证客户姓名时无法获取证件类型");
			return "";
		}
		if(!tips)tips="您输入的";
		var ChineseAmount = $CommonUtil.getIncludeCharAmount(nameString,"Chinese");
		var exp1 = /^[·．\.\u4E00-\u9FA5\uF900-\uFA2D]*$/;//中文字符+“.”+“（”+“）”全角半角“.”
		
		
		var length4Byte = $CommonUtil.getStrLength(nameString);
		switch(parseInt(icType)) {
		case 1:	//身份证
		case 2:	//军官证
			if(!exp1.test(nameString)){
				errmsg=tips+"为无效的名字，只允许含有中文字符、点号，请重新输入";
			}else if(ChineseAmount<2){
				errmsg=tips+"为无效的名字，必须大于等于2个汉字，请重新输入";
			}
			break;
		case 3:	//护照
		case 43:	//华侨护照
			if(length4Byte<4 || $CommonUtil.getNumStringType(nameString) != "NONUM"){
				errmsg=tips+"为无效的名字，必须大于3个字符，且不能全为阿拉伯数字，请重新输入";
			}
			break;
		//case 10:	//代办证件
		case 11:	//士兵证
		case 12:	//人民警察证
		case 13:	//台湾居民来往大陆通行证
		case 22:	//户口簿
		case 23:	//临时身份证
		//case 31:	//香港身份证
		//case 32:	//澳门身份证
		case 33:	//港澳居民来往内地通行证
			if(!exp1.test(nameString)){
				errmsg=tips+"为无效的名字，只允许含有中文字符、英文字母、数字、点号和括号，请重新输入";
			}
			if(ChineseAmount<2){
				errmsg=tips+"为无效的名字，必须大于等于2个汉字，请重新输入";
			}
			break;
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});


/**checkChineseCount
 *校验中文字数
 */
$.validation.addRule("checkChineseCount",{
    check: function(tips,nameString,param) {
		if(!param) param={};
		var errmsg=null;
		if(nameString=="") return null;
		if(!tips)tips="您输入的";
		if(!param.min_number){
			showMsg("校验规则checkChineseCount 缺少参数");
			return "校验规则checkChineseCount 缺少参数";
		}
		var ChineseAmount = $CommonUtil.getIncludeCharAmount(nameString,"Chinese");
		
		if(ChineseAmount<param.min_number){
			errmsg=tips+"为无效的名字，必须大于等于"+param.min_number+"个汉字，请重新输入";
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});

/**checkAddressByIcType
 *根据证件类型验证地址（证件类型定义见数据字典1101 4：）
 */
$.validation.addRule("checkAddressByIcType",{
    check: function(tips,addressString,param) {
		if(!param) param={};
		if(addressString=="") return null;
		var errmsg=null;
		var icType="";
		if(param.ic_type_id){
			icType=$(param.ic_type_id).val();
		}
		if(!tips)tips="您输入的";
		var ChineseAmount = $CommonUtil.getIncludeCharAmount(addressString,"Chinese");
		switch(parseInt(icType)) {
		case 1:	//身份证
		case 2:	//军官证
			if(ChineseAmount<8){
				errmsg=tips+"为无效的地址，须大于等于8个汉字，请重新输入";
			}
			break;
		case 3:	//护照
		case 43:	//华侨护照
			if(ChineseAmount<6){
				errmsg=tips+"为无效的地址，须大于等于6个汉字，请重新输入";
			}
			break;
		//case 10:	//代办证件
		case 11:	//士兵证
		case 12:	//人民警察证
			if(ChineseAmount<8){
				errmsg=tips+"为无效的地址，须大于等于8个汉字，请重新输入";
			}
			break;
		case 13:	//台湾居民来往大陆通行证
			if(ChineseAmount<6){
				errmsg=tips+"为无效的地址，须大于等于6个汉字，请重新输入";
			}
			break;
		case 22:	//户口簿
		case 23:	//临时身份证
		//case 31:	//香港身份证
		//case 32:	//澳门身份证
		case 33:	//港澳居民来往内地通行证
			if(ChineseAmount<8){
				errmsg=tips+"为无效的地址，须大于等于8个汉字，请重新输入";
			}
			break;
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});


/**isConnectPhoneNo
 *验证是否是电话号码（证件类型定义见数据字典1101 4：）
 *须大于等于7位阿拉伯数字，且只能为阿拉伯数字，不能为同一数字或者顺序排序数字。
 */
$.validation.addRule("isConnectPhoneNo",{
    check: function(tips,phoneNo,param) {
		if(!param) param={};
		var errmsg=null;
		var num_type = $CommonUtil.getNumStringType(phoneNo);
		if(phoneNo==""){
		
		}else if(phoneNo.length<7 || num_type != "GENERAL"){
			errmsg = "无效的电话号码,请重新输入.";
			if(tips != null){
				errmsg = tips + "为无效的电话号码,请重新输入.";
			}
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});


/**isCompanyPhoneNo
 *验证是否是电话号码
 *(1)电话号码由数字、"("、")"和"-"构成
 *(2)电话号码为3到8位
 *(3)如果电话号码中包含有区号，那么区号为三位或四位
 *(4)区号用"("、")"或"-"和其他部分隔开 ,区号3位到4位
 *(5)号码不以13或15开头
 */
$.validation.addRule("isCompanyPhoneNo",{
    check: function(tips,phoneNo,param) {
		if(!param) param={};
		var errmsg=null;
		var reg=/(^[0-9]{3,8}$)|(^[0-9]{3,4}[\-]?[0-9]{3,8}[\-]?[0-9]{3,4}$)/;
		var reg2 = /(^13[0-9]*$)|(^15[0-9]*$)|(^18[0-9]*$)/;
		if(reg.test(phoneNo)&&!reg2.test(phoneNo)){
		}else if(phoneNo==""){
		}else{
			errmsg = "该处联系电话号码只能输入固话,请重新输入.";
			if(tips && tips!=""){errmsg = tips + "号码只能输入固话,请重新输入.";}
		};
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});


/**isPhoneNo
 *验证是否是电话号码,
 *(1)电话号码由数字、"("、")"和"-"构成
 *(2)电话号码为3到8位
 *(3)如果电话号码中包含有区号，那么区号为三位或四位
 *(4)区号用"("、")"或"-"和其他部分隔开 ,区号3位到4位
 */
$.validation.addRule("isPhoneNo",{
    check: function(tips,phoneNo,param) {
		if(!param) param={};
		var errmsg=null;
		var reg=/(^[0-9]{3,8}$)|(^[0-9]{3,4}[\-]?[0-9]{3,8}[\-]?[0-9]{3,4}$)/;
		//(^[0-9]{3,4}[\-]?[0-9]{3,8}$)|
		//|(^[0-9]{3,8}$)|(^[0-9]{3,4}[0-9]{3,8}[\-][0-9]{3,4}$)
		if(reg.test(phoneNo)){}
		else if(phoneNo==""){
		
		}
		else{
			errmsg = "无效的电话号码,请重新输入.";
			if(tips != null){errmsg = tips + "为无效的电话号码,请重新输入.";}
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});



/**isPostCode
 *验证是否是邮政编码
 * 这里只验证邮编的6位是否全是数字,并没有严格的校验.
 */
$.validation.addRule("isPostCode",{
    check: function(tips,postCode,param) {
		if(!param) param={};
		var errmsg=null;
		var reg = /^\d{6}$/;
		if(reg.test(postCode)){}
		else if(postCode==""){}
		else{
			errmsg = "无效的邮政编码,请重新输入.";
			if(tips != null){errmsg = tips + "为无效的邮政编码,请重新输入.";}
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});


/**money
 *验证是否是金额
 *必须为合法的数字(整数/浮点数都可以,精度不限制
 */
$.validation.addRule("money",{
    check: function(tips,money,param) {
		if(!param) param={};
		var errmsg=null;
		money=money+"";
		var reg = /^\d+$|^\d+[.]{1}\d+$/;
		if(reg.test(money)){
			var zhengshu_len=0;
			var xiaoshu_len=0;
			if(money.indexOf(".")!=-1){
				var tmp=money.split(".");
				zhengshu_len=tmp[0].length;
				xiaoshu_len=tmp[1].length;
			}else{
				zhengshu_len=money.length;
			}
			if(param.xs_maxlen && xiaoshu_len>param.xs_maxlen){ //小数点后最高位数
				errmsg="金额输入不正确！保留"+param.xs_maxlen+"位小数！";
			}
		}
		else if(money==""){}
		else{
			errmsg = "无效的金额,请重新输入.";
			if(tips != null){errmsg = tips + "为无效的金额,请重新输入.";}
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});


/**isNum
 *验证是纯数字
 */
$.validation.addRule("isNum",{
    check: function(tips,num,param) {
		if(!param) param={};
		var errmsg=null;
		var reg = /^\d*$/;
		if(reg.test(num)){}
		else if(num==""){}
		else{
			errmsg = "无效的数字,请重新输入。";
			if(tips != null){errmsg = tips + "为无效的数字,请重新输入。";}
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});

/**isNumOrLetter
 *验证是否是数字和字母组成的字符串
 */
$.validation.addRule("isNumOrLetter",{
    check: function(tips,num,param) {
		if(!param) param={};
		var errmsg=null;
		var reg = /^[A-Za-z0-9]*$/;
		if(reg.test(num)){}
		else if(num==""){}
		else{
			errmsg = "必须为字母或者数字组成,请重新输入.";
			if(tips != null){errmsg = tips + "必须为字母或者数字组成,请重新输入.";}
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});

/**isValidCustName
 *验证字段是否是中文字符、英文字母、数字，如果是返回null.否则返回提示信息.
 */
$.validation.addRule("isValidCustName",{
    check: function(tips,fieldValue,param) {
		if(!param) param={};
		if(!tips) tips="";
		var errmsg=null;
		var c_2 = 0,c_4 = 0;
		var exp1 = new RegExp("^[A-Za-z]*$");
		var exp2 = new RegExp("^[0-9]*$");
		var exp3 = new RegExp("^[\u4E00-\u9FA5\uF900-\uFA2D]*$");
		var exp4 = new RegExp("^[()|（）]*$"); //add by zb 13852-1 增加匹配括号(全角或)
		var exp5 = new RegExp("^[<>|《》]*$"); //add by yuxing 64560-1 增加匹配书名号(全角或)
		var exp6 = new RegExp("^[·]*$"); //add by zxz 67995-1 增加特殊字符
		for(var i=0;i<fieldValue.length;i++){	    
		    var _char = fieldValue.substr(i,1);
		    if(exp1.test(_char)){
		        continue;
		    }else if(exp2.test(_char)){
		    	c_2++;
		        continue;
		    }else if(exp3.test(_char)){
		    	continue;
		    }else if(exp4.test(_char)){
		    	c_4++;
		    	continue;
		    }else if(exp5.test(_char)){
		    	c_4++;
		    	continue;
		    }else if(exp6.test(_char)){
		    	c_4++;
		    	continue;
		    }else{
				errmsg="(客户姓名不正确，只允许含有中文字符、英文字母、数字和括号，请重新输入!)";
				if(tips!=null && tips!=""){
					 errmsg = tips + ",只允许含有中文字符、英文字母、数字和括号，请重新输入!)";   
				}
				break;
		    }
		}
		if(errmsg==null && c_2+c_4>=fieldValue.length){
			errmsg=tips+"不能全为数字或字符，请重新输入!"
		}
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});


/**charLength
 *校验字节数,一个中文占2字节
 */
$.validation.addRule("charLength",{
    check: function(label,str,param) {
		if(!param) param={};
		if(str=="") return null;
		var errmsg=null;
		var length4Byte = $CommonUtil.getStrLength(str);
		if(param.max && !param.min){
			if(length4Byte>param.max){
				errmsg="长度不能超过"+param.max+"字节数";
			}
		}else if(!param.max && param.min){
			if(length4Byte<param.min){
				errmsg="长度不能少于"+param.min+"字节数";
			}
		}else if(!param.max && param.min){
			if(length4Byte>param.max && length4Byte<param.min){
				errmsg="长度必须在"+param.min+" 和 "+param.max+"字节数之间";
			}
		}else{
			errmsg="字节数校验参数不完整,请确认"
		}
		if(label && errmsg) errmsg=label+" "+errmsg;
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});


//集团编码判断
$.validation.addRule("isGroupId",{
    check: function(label,group_id,param) {
		if(group_id=="") return null;
		if(!param) param={};
		var errmsg=null;
		var reg =/^\d{10,11}$/;
		
		if(reg.test(group_id)){return null;}
		else{
			errmsg = "无效的集团编码,请重新输入.";
	    };
		
		if(label && errmsg) errmsg=label+" 为"+errmsg;
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});


//用户密码判断
$.validation.addRule("userpassword",{
    check: function(label,password,param) {
		if(!param) param={};
		if(!label) label="密码";
		var errmsg=null;
		var reg_len =/^\d{6}$/;
		
		if(!password) errmsg=label+"不允许为空";
		else if(param.repassword && password!=param.repassword){
			errmsg="输入的密码不一致,请重新输入";
		}else if(!reg_len.test(password)){
			errmsg=label+"必须为6位数字";
		}else if(IDOM.matchContinuousNum(password)){
			errmsg=label+"不能为顺序或倒序的连号！";
		}else if(IDOM.matchRepeatNum(password)){
			errmsg=label+"不能为重复号码，请重新输入！";
		}else if(param.oldpassword && password==param.oldpassword){
			errmsg="新旧密码不能相同,请重新输入";
		}else if(param.ic_no && param.ic_no.indexOf(password)!=-1){
			errmsg=label+"不能为客户身份证件的连续数字！";
		}else if(param.msisdn && param.msisdn.indexOf(password)!=-1){
			errmsg=label+"不能为客户手机号的连续数字！";
		}else if(param.spec_card_num && param.spec_card_num.indexOf(password)!=-1){
			errmsg=label+"不能为专属卡的连续数字！";
		}
		
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});

/*
 * 是否携号转网号码判断
 */
$.validation.addRule("isNpCode",{
    check: function(label,mobileNo,param) {
		if(mobileNo=="") return null;
		if(!param) param={};
		var reg1x = /(^1[0-9]{10}$)/;
		var errmsg=null;
		if(!reg1x.test(mobileNo)){
			errmsg="必须是1开头的11位数字,请重新输入";
		}
		if(errmsg && param.errMsg) errmsg=param.errMsg;
		if(label && errmsg) errmsg=label+errmsg;
		if(errmsg && param.is_tips) showMsg(errmsg);
		return errmsg;
    }
});
```
# 技术栈
后端采用 Springboot 3.3.2开发，JDK版本17.
前端采用vue3.X版本，使用element plus UI 。
前后端采用Rest接口交互。